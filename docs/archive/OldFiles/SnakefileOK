#-----------------------------------------------------------
# Author:   Tim Boyarski                                    
# Date:     2017-02-28                                      
#-----------------------------------------------------------
# Rule specific configurations set in:      ReBamPlus.json          
# Rule specific parameters set in:          ReBamPlus.yaml          
# Input:                                    .BAM                    
# Output:                                   1.fastq                 
#                                           2.fastq                 
#                                           realigned.BAM           
#                                           realigned_sorted.BAM,   
#                                           realigned_sorted.BAM.BAI
# Purpose: This is a workflow. It will accept and reassemble a raw  
#   .BAM file. Typically this is performed on .BAM files which have 
#   been generated using an unknown or older version of SAMTools.   
#   This process is to ensure consistency, and results in .BAM files
#   generated from documented versions of SAMTools.                 
#------------------------------------------------------------------- 

# Current directory:
currDIR = "/home/tboyarski/share/projects/tboyarski/gitRepo-LCR-BCCRC/Snakemake/ReBamPlus/"

# Include cluster configuration file.
configfile: currDIR + "ReBamPlus.yaml"

# Include all required Snakefiles.
#   undoBAM:    Fastq generation from a BAM file
#   alignBAM:   BAM generation from a Fastq file
#   sortBAM:    Sorting of the BAM file
#   indexBAM:   Indexing of a BAM file
include: currDIR + "undoBAM"
include: currDIR + "alignBAM"
include: currDIR + "sortBAM"
include: currDIR + "indexBAM"

# Rule to drive the workflow. Uncomment desired rule, or call from CLI using:
#           Template:   snakefile bam/{samples}_realigned_sorted.bam.bai
#           E.g.        snakefile bam/Pfieffer_realigned_sorted.bam.bai
rule all:
    input: 
#           expand("fastq/{samples}.{version}.fastq", samples=config["sample"], version=config["version"])              #P1:SAMtoFastq
#           expand("bam/{samples}_realigned.bam", samples=config["sample"])                                             #P2:alignBAM
#           expand("bam/{samples}_realigned_sorted.bam", samples=config["sample"])                                      #P3:sortBAM
           expand("{bamDIR}/{samples}_realigned_sorted.bam.bai", bamDIR=config["bamDIR"], samples=config["sample"])    #P4:indexBAM
#            "bam/Pfeiffer2_realigned_sorted.bam.bai"
