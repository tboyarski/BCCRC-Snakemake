# varScan Module (Multi-Snakemake)
This directory contains the varScan module. It is a single-module system.

## Modules:
See invidual files for expanded explanations of their purpose and the manner in which they accomplish it.
* mpileup2UNSPLIT: Generate single '.VCF' file from single '.mpileup' file.
* mpileup2SPLIT: Generate single chromosomal '.VCF' files from single chromosomal '.mpileup' files.
* mpileup2MERGE: Merge chromosomal '.VCF' files into a genomic '.VCF' file.
* somTumorNormalUNSPLIT: Generate single '.VCF' file from a pair of tumor-normal '.mpileup' file.
* somTumorNormalSPLIT: Generate single chromosomal '.VCF' files from a pair of tumor-normal chromosomal '.mpileup' files.
* somTumorNormalMERGE: Merge tumor-normal chromosomal '.VCF' files into a genomic '.VCF' file.
* **varScan_INCLUDE: Generate '.VCF' file from a '.mpileup' file.**

## Logging:
Will be stored in: "log/varScan"

## Global Directories:
* outputDIR = Directory to contain all file generated by the pipeline

## Global Paramters:
Module | Argument | Default Value | Description
:--------: | :--------: | :--------: | :--------
mpileup2MERGE, somTumorNormalMERGE | chrLIST | ['chr1', ... 'chrY'] OR ['1', ... 'Y'] | List of organism (Human or Mouse) and format (NCBI or UCS) specific chromosomes
## Module Specific Paramters:
Module |Argument | Default Value | Description
:--------: | :--------: | :--------: | :--------
mpileup2SPLIT, mpileup2UNSPLIT | mpileup2_varScanProg | varscan | Version of varScan to be used.
somTumorNormalSPLIT, somTumorNormalUNSPLLIT | somTumorNormal_varScanProg | varscan | Version of varScan to be used.
*SPLIT, *UNSPLIT | mpileDIR | mPile | Directory provides '.pileup' files to be processed.
*SPLIT, *UNSPLIT, *MERGE | varScanSplitDIR | varScanSplit | Directory to store chromosomal '.VCF' file prior to their merge.
*MERGE | varScanDIR | varScan | Log directory and core directory to store files.
*SPLIT, *UNSPLIT | minCOV | --min-coverage 20 | Minimum read depth at a position to make a call.
*SPLIT, *UNSPLIT | minREAD | --min-reads2 10 | Minimum supporting reads at a position to call variants.
*SPLIT, *UNSPLIT | minQUAL | --min-avg-qual 20 | Minimum base quality at a position to count a read.
*SPLIT, *UNSPLIT | minFREQ | --min-var-freq 0.01 | Minimum variant allele frequency threshold.
*SPLIT, *UNSPLIT | pVALUE | --p-value 0.05 | Default p-value threshold for calling variants.
*SPLIT, *UNSPLIT | strandFILT | --strand-filter 0 | Ignore variants with >90% support on one strand.
*SPLIT, *UNSPLIT | outVCF | --output-vcf 1 | If set to 1, outputs in VCF format.
*SPLIT | varScanChrSplit | True | Process samples by chromosome, and then merge to single '.VCF'.
somTumorNormalSPLIT, somTumorNormalUNSPLIT | minSTRAND | --min-strands2 0 | Minimum number of strands on which variant observed.
somTumorNormalSPLIT, somTumorNormalUNSPLIT | posVALID | --validation 1 | If set to 1, outputs all compared positions even if non-variant.


## WARNINGS:
```
Not resetting normal file because...
```
This is becuase the two mpileup files provided to varScan have different levels of coverage at different points. 
In the makefile example, process substitution is used to compute both the tumor and the normal mpileup files in 
a single call to generate a single file. The single file in this case is already adjusted, whereas, when submitting
two separate files, the adjustments are made later and are subsequently reported.
Change varScan somatic calls to accept a single file (--mpileup 1) to avoid this message.
This was not done as the coding for inline process substitution is not easily understood, preferred the clarify of 
generating two separate files and providing them together.
Concerns may exist for moments disk usage overhead, by not piping the output directly this increases the footprint
of the Snakerun. However, it also drastically reduces the memory footprint as an entire chromosome or sample is no
longer needed to be stored in memory.




varScank.mk did not use the '-bh -F 512' flag when calculating indels for single samples, or when calcualting any tumor-normal pairs.
The snakemake equivalents all use the same code, so they all will use the '-bh -F 512' flags.
